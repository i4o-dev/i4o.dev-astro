---
import { getCollection } from 'astro:content'
import { format } from 'date-fns'
import Layout from '@/layouts/Layout.astro'
import { sortAndGroupPostsByYear } from '@/utils/helpers'

const allBookNotes = await getCollection('bookNotes')
const onlyPublished = allBookNotes.filter((note) => !note.data.draft)
const sortedNotes = onlyPublished.sort(
	(a, b) =>
		new Date(b.data.date_published).valueOf() -
		new Date(a.data.date_published).valueOf()
)
---

<Layout title='Blog'>
	<main class='flex flex-col gap-20'>
		<article class='flex flex-col gap-8'>
			<h1 class='text-3xl text-neutral-100 font-serif'>Book Notes</h1>
			<section class='flex flex-col gap-4'>
				<div class='flex flex-col items-start gap-4'>
					{
						sortedNotes.map((post, index) => (
							<div
								class='flex flex-wrap items-center justify-start gap-2 text-left'
								key={`post-${index}`}
							>
								<a
									href={`/book-notes/${post.slug}`}
									class:list={{
										['hover:text-neutral-100 m-0 text-base font-normal leading-6']: true,
									}}
								>
									{post.data.title}
								</a>
								<span class='text-xs italic'>
									{format(
										new Date(post.data.date_published),
										'MMM dd'
									)}
								</span>
							</div>
						))
					}
				</div>
			</section>
		</article>
	</main>
</Layout>
